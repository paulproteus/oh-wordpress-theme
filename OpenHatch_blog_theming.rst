A step-by-step guide to updating the OpenHatch blog theme
=========================================================

In this document, you will see the steps for generating a new WordPress
theme based on the latest deployed code in "oh-mainline".

("oh-mainline" refers to the main OpenHatch code, available at
https://github.com/openhatch/oh-mainline .)

As a quick overview, the steps are:

* Visit a special page within the OpenHatch site, and download that into the input/ directory.

* Configure the code in this repository to generate the right metadata for the theme.

* Run "make" within this repository.

* Gleefully examine the output/ directory and the autogenerated theme

* (Optional but recommended) Test that theme on a local WordPress instance

* Upload the output/ directory to the OpenHatch blog server

Note that, due to the way we use "less" CSS at the moment, the blog
server and the OpenHatch server have to be on the same host and
port. Once we switch to generating pure CSS files server-side, this
restriction will go away.

Also, eventually, the steps in this guide will be automated. Even after
the steps are automated, some version of this document will remain so that
the process is clear.

Make sure you have a copy of this repo locally
==============================================

If you are reading this on the web, now is the time to make sure your computer
has a copy of the oh-wordpress-theme project. To get it, do this::

 git clone https://github.com/paulproteus/oh-wordpress-theme.git

Switch directory into it::

 cd oh-wordpress-theme

Downloading the input file
==========================

Run this command::

 wget https://openhatch.org/+theme-stubs/wordpress/index -O input/index.html

Configure this repository
=========================

Run this command::

 cp theme.cfg.OPENHATCH theme.cfg

Run "make"
==========

This is the easiest part. The theme autogeneration is driven by the simple
command-line tool called "make". Note that if you do not have make, you
will have to install it. (If you need help with that, ask Asheesh.)

Run this command::

 make

It will print a bunch of output indicating that it did a lot of work. Great!

Examine output/
===============

Now take a look at the directory called output::

 ls output/

You should see the following files:

* style.css: This is a stub style file. It only contains information about the theme, and no actual CSS. (All actual WordPress CSS is in the oh-mainline repository, so that it is all located in the same place.)
* index.php: This is the one and only WordPress theme file. It is automatically generated by splicing pieces together of input/index.html and the various snippets in replacements/\*.
* functions.php: This is copied wholesale from morphololgy/static/. By having this file here, we declare to WordPress that our sidebar can handle widgets.

Feel free to take a look at them!

Test the them on a local WordPress (optional)
=============================================

If you're curious what the theme will look like, you should test it
out in a web browser on a WordPress instance of your choosing.

Personally, for development, I keep a WordPress instance on my laptop.
It's available at http://localhost/~paulproteus/wordpress/ (but that link
will only work for me). Because of the current situation with less CSS files
being rendered within the browser, and due to rules about the "Same Origin"
policy, to make the site look right you must run::

 chromium --disable-web-security

to preview the theme properly.

Also, I like to use a "symbolic link" (also known as "soft link") in a
fashion like this::

 ln -s ~/projects/oh-blog-theme/output/ ~/public_html/wordpress/wp-content/themes/ohtest/

That means that every time I run "make" to update the them, I can just go into
the web browser pointed at my local WordPress instance and hit 'reload'.

Upload the resulting theme
==========================

This is probably the most complicated step, as it requires access to
the main OpenHatch blog. For now, access to the WordPress blog files
is a bit fiddly.

The OpenHatch WordPress blog is located at this path on
linode.openhatch.org::

 /var/www/blog

and the OpenHatch theme is here in particular::

 /var/www/blog/wp-content/themes/hatch

Thanks
======

Major thanks go out to Karen Rustad, whose work on the OpenHatch blog
theme over the years provided the snippets that this project uses.
